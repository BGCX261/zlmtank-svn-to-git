#####################################################################
#                         CL386.DOC (Russian)                       # 
#####################################################################

0. Введение.
    0.1 Для чего нужна CL386 ?
    0.2 Чему подобна CL386 ?
1. Как работает CL386 ?
    1.1 Что необходимо для работы CL386 ?
    1.1 Алгоритм работы CL386.
    1.2 Замечания об использовании.
    1.3 Коды возврата.
2. Опции CL386.
A. Приложения.
    A.0 Использование TASM v4.1 для DOS.
    A.1 Гарантии.
    A.2 Copyright.
    A.3 Как связаться с автором ?

#####################################################################


0. Введение.
************ 

0.1 Для чего нужна CL386 ?

CL386 - это программа- оболочка для компилирования, ассемблирования  и
линкования.  Она  написана  специально  для СС386.EXE,  но может  быть
использована и с другими программами.

CL386  работает  в MS- DOS,  но  если  Вы перепишите  _splitpath( ) и 
_makepath(), то нет никаких препятствий для работы под другими OS.

0.2 Чему подобна CL386 ?

Аналоги CL386: CL.EXE(Microsoft/ VisualC/C++ ), BCC.EXE(Borland C/C++),
WCL.EXE(Watcom C/C++), SC.EXE(Symantec C/C++).


1. Как работает CL386 ?
***********************
    
1.1 Что необходимо для работы CL386 ?

Для работы CL386 необходимы  следущие файлы :  CC386.EXE,  TASM.EXE, 
 TLINK.EXE или WLINK.EXE. Проверьте  ( или добавте )  путь к этим 
программам в переменную окружения PATH !

1.1 Алгоритм работы CL386.

1) Сначала читаются параметры.  Параметры - это  либо имя файла,  либо
опция. Параметры вы можете задавать в:
    - конфигурационном  файле CL386.CFG.  Если  Вы переименовали  файл
CL386.EXE  в   <name>.EXE,  то  в  файле   <name>.CFG.   Поиск  файла
конфигурации  проходит  в  такой   последовательности  :   в   текущей
директории,  а если  не  найден -   то в  директории,  из  которой  Вы
запустили CL386.EXE. 
    - переменной окружения  CL386.  Укажите,  например, в AUTOEXEC.BAT
SET CL386=...  и не беспокойтесь о параметрах по умолчанию... :)  
    - в коммандной строке при запуске.
2) Далее  генерируются  файлы CC386.$$$,  TASM.$$$ &  LINK.$$$  для
подстановки в соответствующие программы. 
3) Вызываются CC386.EXE, TASM.EXE & TLINK.EXE(WLINK.EXE) до появления 
ошибки !!!
4) Если нет параметров  в коммандной строке или найдена  опция /?  или
нет файлов, то выдается краткая справка об опциях.

1.2 Замечания.

-  Для подключения большого кол-ва файлов используйте опцию @filename,  
и разместите в filename список  файлов и опций, разделленых  пробелами
или символами новой строки; 
-  Используйте опцию /K для просмотра файлов  CC386.$$$ , TASM.$$$ &  
LINK.$$$; 
- Используйте опцию /v для получения отладочной версии программы;
- Не добавляйте опцию /? в CL386.CFG или в переменную окружения CL386;
- По умолчанию запрещено выводить файлы листинга, разрешить /l ;
- Я вывожу файл листинга .ASM файла в файл с расширением .LSA .

2. Опции CL386.
***************

/i - выдать файл после  препроцессора, может быть /i+  или /i-, /i  то
    же, что и /i+; 
/l  - выдать .LST файл, может быть /l+ или /l-, /l то же, что и /l+;
/e  - выдать файл ошибок, может быть /e+ или /e-, /e то же, что и /e+;
/A  - установить ANSI совместимость, может быть /A+ или /A-, /A  то же,
    что и /A+;
/w-xxx  - запретить предупреждения, смотри документацию по CC386.EXE;
/Cxxx   - опция для генерации кода, смотри документацию по CC386.EXE;
/Dxxx   - определить символ для препроцессора, смотри документацию по
    CC386.EXE;
/Enn    - определить max количество ошибок для CC386;
/Ipath  - определить путь к включаемым файлам;
/Oxxx   - опция для оптимизации, смотри документацию по CC386.EXE;
@name   - определить файл с параметрами для подстановки;
/K  - не удалять файлы CC386.$$$, TASM.$$$ & LINK.$$$; 
  может быть /K+ или /K-, /K то же, что и /K+;
/k  - не удалять файлы с расширением .ASM & .OBJ, полученные из .CPP & .ASM 
  может быть /k+ или /k-, /k то же, что и /k+;
/Lxxx   - определить путь к  файлам .LIB & .OBJ;
/a  - генерировать только .ASM файлы;
/c  - генерировать только .OBJ файлы;
/v  - полная информация об отладке и отладочная версия;
/m  - генерировать .MAP файл;
/n  - не подключать файлы по умолчанию;
/Tp - использовать TLINK и PMODE
/Tl - использовать TLINK и PMODE, 
	startup модуль НЕ копирует код в DPMI память
/Tw - использовать WLINK и PMODE/W
/Td - использовать WLINK и D4GWSTUB - для DOS/4GW
/Rname - установить имя .EXE файла
/?, /h, /H  - подсказка.

1.3 Коды возврата.

Программа возвращает следущие коды возврата :

  	  0  - Ok
	128  - Фатальные ошибки ( Нет памяти, другие )
	129  - Проблемы с открытием файлов, выполнением EXEC
	
Также возвращаются коды возврата CC386, TASM & TLINK(WLINK) !

A. Приложения
*************

A.0 Использование TASM v4.1 для DOS.

НЕ ИСПОЛЬЗУЙТЕ TASM v4.1 !!! Откомпилируйте пример с TASM v4.1 :

============================================= 1.ASM
        .model tiny
        .code
        .386
start:
        rept 1024
        local hi
        jc hi
hi:
        endm
        end start
=============================================

	tasm /m2 1.ASM
	tlink /3/c/t 1.OBJ

и посмотрите в disassembler'e код в 1.COM :(

A.1 Гарантии.

Данная  программа есть  FREEWARE и поставляется  с исходными текстами.  
Автор не  несет НИКАКОЙ  ответственности за  ущерб,  принесенный  этой
программой. Вы используете эту программу на свой страх и риск !!!

A.2 Copyright.

(c) CL386 Kirill Joss
(c) CC386 David Lindauer (gclind01@starbase.spd.louisville.edu)

A.3 Как связаться с автором ?

Ваши предложения и пожелания шлите по адресам :

Kirill Joss
e-mail: jk@zi3.cyb.univ.kiev.ua
    or
FidoNet:    2:463/218.12
    AKA     2:463/59.29
